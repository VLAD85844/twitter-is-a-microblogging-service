# Тема: «Сервис микроблогов»

## Описание проекта

Этот проект представляет собой RESTful API сервис на FastAPI, реализующий функционал мини-блога (аналог Twitter).

Сервис позволяет пользователям:

- Создавать твиты (с текстом и вложениями);
- Просматривать ленту твитов пользователей, на которых они подписаны;
- Лайкать и удалять лайки с твитов;
- Подписываться и отписываться от других пользователей;
- Загружать и получать изображения, привязанные к твитам.

Аутентификация осуществляется через API-ключ, передаваемый в заголовке **`api-key`**.

## Функциональность

- **Публикация твитов**: Твит может содержать текст и вложенные медиафайлы;
- **Лента твитов**: Отображение твитов пользователей, на которых подписан текущий пользователь;
- **Лайки**: Возможность поставить и убрать отметку "Нравится";
- **Подписки**: Подписка на других пользователей и управление фолловингом;
- **Работа с изображениями**: Загрузка и получение медиафайлов, привязанных к твиту.

## Требования к окружению

- **Python** >= 3.9
- **PostgreSQL** >= 14 (по умолчанию используется в Docker)
- **Docker и Docker Compose** (для контейнеризированного развертывания)
- **FastAPI**, **Uvicorn**, **SQLAlchemy**, **Alembic**, **python-multipart**, **pytest-asyncio**, **pytest**, **python-dotenv** (установятся автоматически через `requirements.txt`)

## Установка и запуск

### Локальный запуск (без Docker)

1. Клонировать репозиторий и перейти в директорию проекта:
   ```sh
   git clone <URL_репозитория>
   cd my_twitter_clone
   ```
2. Установить зависимости:
   ```sh
   pip install -r requirements.txt
   ```
3. Применить миграции для базы данных:
   ```sh
   alembic upgrade head
   ```
4. Запустить сервер:
   ```sh
   uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
   ```
5. Открыть API в браузере: [http://localhost:8000/docs](http://localhost:8000/docs)

### Запуск через Docker

1. Убедитесь, что Docker установлен и запущен;
2. Соберите и запустите контейнеры:
   ```sh
   docker-compose up --build
   ```
3. API будет доступно на `http://localhost:8000`

## Примеры API-запросов

### Создание твита

**POST** `/api/tweets/`

```json
{
  "tweet_data": "Это мой первый твит!",
  "tweet_media_ids": [10, 15]
}
```

Ответ:

```json
{
  "result": true,
  "tweet_id": 39
}
```

### Получение ленты твитов

**GET** `/api/tweets/`

```json
{
  "result": true,
  "tweets": [
    {
      "id": 123,
      "content": "Привет, это мой первый твит!",
      "attachments": ["/api/medias/10", "/api/medias/15"],
      "author": { "id": 1, "name": "TestUser" },
      "like_count": 1,
      "created_at": "2025-03-10T18:30:00"
    }
  ]
}
```

### Подписка на пользователя

**POST** `/api/users/{user_id}/follow`
Ответ: `{ "result": true }`

### Удаление твита

**DELETE** `/api/tweets/{tweet_id}`
Ответ: `{ "result": true }`

## Документация API

Полная документация доступна в формате Swagger и ReDoc:

- [Swagger UI](http://localhost:8000/docs) – удобный интерфейс для тестирования API;
- [ReDoc](http://localhost:8000/redoc) – альтернативный интерфейс OpenAPI.

## Спасибо за внимание! 


